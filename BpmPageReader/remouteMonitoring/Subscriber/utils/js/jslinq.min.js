/* $linq Version 1.5.1 (by Kurtis Jones @ https://github.com/battousai999/js-linq) */!function(a,b){var c={};c.map=function(a,d){var e=arguments[2];if(a.map!==b)return a.map(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=new Array(f),h=0;f>h;h++)h in a&&(g[h]=d.call(e,a[h],h,a));return g},c.filter=function(a,d){var e=arguments[2];if(a.filter!==b)return a.filter(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=new Array,h=0;f>h;h++)if(h in a){var i=a[h];d.call(e,i,h,a)&&g.push(i)}return g},c.every=function(a,d){var e=arguments[2];if(a.every!==b)return a.every(d,e);var f=a.length;if(!c.isFunction(d))throw new TypeError;for(var g=0;f>g;g++)if(g in a&&!d.call(e,a[g],g,a))return!1;return!0},c.some=function(a,c){var d=arguments[2];if(a.some!==b)return a.some(c,d);for(var e=a.length,f=0;e>f;f++)if(f in a&&c.call(d,a[f],f,a))return!0;return!1},c.object_keys=function(a){if(Object.keys!==b)return Object.keys(a);if(a!==Object(a))throw new TypeError("object_keys called on a non-object.");var c,d=[];for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&d.push(c);return d},c.isFunction=function(a){return"function"==typeof a},c.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.extendDeferredSort=function(a,b){var c=function(a){return{keySelector:a.keySelector,comparer:a.comparer,reverse:a.reverse,next:null==a.next?b:c(a.next)}};return c(a)},c.createLambda=function(a){if(c.isFunction(a))return a;if("string"==typeof a&&""!==a){if(a.indexOf("=>")<0)return new Function("$,$$,$$$","return "+a);var b=a.match(/^\s*\(?\s*([^)]*)\s*\)?\s*=>(.*)/);return new Function(b[1],"return "+b[2])}return a},c.processDeferredSort=function(a){if(null!=a.deferredSort){var b=function(a,c,d){var e;return e=d.reverse?d.comparer(d.keySelector(c),d.keySelector(a)):d.comparer(d.keySelector(a),d.keySelector(c)),0==e?null==d.next?0:b(a,c,d.next):e};a.array.sort(function(c,d){return b(c,d,a.deferredSort)}),a.deferredSort=null}},c.identity=function(a){return a},c.merge=function(a,b){return[a,b]},c.isString=function(a){return"string"==typeof a||a instanceof String},c.isBoolean=function(a){return"boolean"==typeof a||a instanceof Boolean},c.isNumber=function(a){return"number"==typeof a||a instanceof Number},c.caseInsensitiveComparer=function(a,b){var d=c.isString(a)?a.toLowerCase():a,e=c.isString(a)?b.toLowerCase():b;return e>d?-1:d>e?1:0},c.caseSensitiveComparer=function(a,b){return b>a?-1:a>b?1:0},c.defaultStringComparer=c.caseSensitiveComparer,c.strictComparer=function(a,b){return a===b},c.normalizeComparer=function(a){return function(b,d){var e=a(b,d);if(c.isBoolean(e))return e;if(c.isNumber(e))return 0==e;throw new Error("Invalid value from comparer function.")}};var d=function(a){var b=!0;arguments.length>=1&&null!=arguments[1]&&!arguments[1]&&(b=!1),b?this.array=null==a?[]:a.slice(0):this.array=a,this.deferredSort=null};d.isFunction=c.isFunction,d.isArray=c.isArray,d.identity=c.identity,d.isString=c.isString,d.isBoolean=c.isBoolean,d.isNumber=c.isNumber,d.caseInsensitiveComparer=c.caseInsensitiveComparer,d.caseSensitiveComparer=c.caseSensitiveComparer,d.defaultStringComparer=c.defaultStringComparer,d.strictComparer=c.strictComparer,d.from=function(a){return null==a?new d([]):a instanceof d?a:c.isArray(a)?new d(a):jQuery&&a instanceof jQuery?new d(a.get()):new d([a],!1)},d.range=function(a,b,c){if(null==a||isNaN(a))throw new Error("Invalid 'from' value.");if(null==b||isNaN(b))throw new Error("Invalid 'to' value.");(null==c||isNaN(c))&&(c=1);for(var e=[],f=a;b>=f;f+=c)e.push(f);return new d(e,!1)},d.repeat=function(a,b){(null==b||isNaN(b))&&(b=1);for(var c=[],e=0;b>e;e++)c.push(a);return new d(c,!1)},d.matches=function(a,b,c){if(null==b)throw new Error("Invalid 'pattern' value.");if(null==a)return new d([]);if("string"!=typeof a)throw new Error("Parameter 'text' is not a string.");null==c&&(c=""),c.indexOf("g")<0&&(c+="g");var e;b instanceof RegExp?(c.indexOf("i")<0&&b.ignoreCase&&(c+="i"),c.indexOf("m")<0&&b.multiline&&(c+="m"),e=b.source):e=b;var f=new RegExp(e,c),g=a.match(f);return new d(null==g?[]:g,!1)},d.properties=function(a,b,e){if(null==a)return new d([]);null!=b&&""!=b||(b="key"),null!=e&&""!=b||(e="value");var f=function(c){var d={};return d[b]=c,d[e]=a[c],d};return new d(c.map(c.object_keys(a),f),!1)},d.prototype={aggregate:function(a,b,d){if(b=c.createLambda(b),d=c.createLambda(d),null==b||!c.isFunction(b))throw new Error("Invalid operation.");if(null!=d&&!c.isFunction(d))throw new Error("Invalid result selector.");c.processDeferredSort(this);var e=this.array.length;if(0==e&&null==a)throw new Error("Cannot aggregate on empty collection when seed is not given.");for(var f=null==a?this.array[0]:a,g=null==a?1:0,h=g;e>h;h++)h in this.array&&(f=b(f,this.array[h]));return null==d?f:d(f)},all:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),c.every(this.array,a)},any:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),null==a?this.array.length>0:c.some(this.array,a)},average:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=0,e=1,f=0;b>f;f++)if(f in this.array){var g=null==a?this.array[f]:a(this.array[f]);if(null==g)continue;if(isNaN(g))throw new Error("Encountered an element that is not a number.");d+=(g-d)/e,e+=1}return d},batch:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");if(null==a||isNaN(a)||0>=a)throw new Error("Invalid size.");c.processDeferredSort(this);for(var e=[],f=0,g=this.array.length,h=null,i=0;g>i;i++)i in this.array&&(null==h&&(h=[],e.push(h)),h[f]=null==b?this.array[i]:b(this.array[i]),f+=1,f==a&&(h=null,f=0));return new d(e,!1)},concat:function(a){if(c.processDeferredSort(this),null==a)return new d(this.array);var b=d.from(a);return c.processDeferredSort(b),new d(this.array.concat(b.array),!1)},contains:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");return null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this),c.some(this.array,function(c){return null==b?c===a:b(c,a)})},count:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");if(c.processDeferredSort(this),null==a)return this.array.length;for(var b=this.array.length,d=0,e=0;b>e;e++)e in this.array&&a(this.array[e])&&(d+=1);return d},defaultIfEmpty:function(a){return c.processDeferredSort(this),0==this.array.length?new d([a],!1):new d(this.array)},distinct:function(a){return this.distinctBy(c.identity,a)},distinctBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");return c.processDeferredSort(this),this.groupBy(a,null,b).select(function(a){return new d(a.values,!1).first()})},elementAt:function(a){if(null==a||isNaN(a)||0>a||a>=this.array.length)throw new Error("Invalid index.");return c.processDeferredSort(this),this.array[a]},elementAtOrDefault:function(a,b){return null==a||isNaN(a)||0>a||a>=this.array.length?b:(c.processDeferredSort(this),this.array[a])},equiZip:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");null==b&&(b=c.merge),c.processDeferredSort(this);var e=d.from(a);if(c.processDeferredSort(e),this.array.length!=e.array.length)throw new Error("The two collections being equi-zipped are not of equal lengths.");for(var f=this.array.length,g=[],h=0;f>h;h++)g.push(b(this.array[h],e.array[h]));return new d(g,!1)},except:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this),null==a&&(a=[]);var e=d.from(a);c.processDeferredSort(e);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=function(a){return null==b?a===i:b(a,i)},k=c.some(g.array,j),l=c.some(e.array,j);k||l||g.array.push(i)}return g},first:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)if(d in this.array&&(null==a||a(this.array[d])))return this.array[d];throw new Error("No first item was found in collection.")},firstOrDefault:function(a,b){if(1==arguments.length&&c.isFunction(a)&&(b=a,a=null),b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length,e=0;d>e;e++)if(e in this.array&&(null==b||b(this.array[e])))return this.array[e];return a},foreach:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid action.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)d in this.array&&a(this.array[d],d)},groupBy:function(a,b,e){if(a=c.createLambda(a),b=c.createLambda(b),e=c.createLambda(e),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid element selector.");if(null!=e&&!c.isFunction(e))throw new Error("Invalid key comparer.");null!=e&&(e=c.normalizeComparer(e)),c.processDeferredSort(this);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++){var i=this.array[h],j=a(i),k=null==b?i:b(i),l=g.firstOrDefault(null,function(a){return null==e?a.key===j:e(a.key,j)});null==l?g.array.push({key:j,values:[k]}):l.values.push(k)}return g},groupJoin:function(a,b,e,f,g){if(b=c.createLambda(b),e=c.createLambda(e),f=c.createLambda(f),g=c.createLambda(g),null==a)throw new Error("Invalid inner collection.");if(null==b||!c.isFunction(b))throw new Error("Invalid outer key selector.");if(null==e||!c.isFunction(e))throw new Error("Invalid inner key selector.");if(null==f||!c.isFunction(f))throw new Error("Invalid result selector.");if(null!=g&&!c.isFunction(g))throw new Error("Invalid key comparer.");null!=g&&(g=c.normalizeComparer(g)),c.processDeferredSort(this);for(var h=d.from(a),i=h.groupBy(e,null,g),j=this.array.length,k=[],l=0;j>l;l++)if(l in this.array){var m=this.array[l],n=b(m),o=i.firstOrDefault(null,function(a){return null==g?a.key===n:g(a.key,n)});k.push(f(m,null==o?[]:o.values))}return new d(k,!1)},index:function(a){if(null==a&&(a=0),isNaN(a))throw new Error("Invalid startIndex");return this.select(function(b,c){return{key:a+c,value:b}})},indexOf:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=0;b>d;d++)if(d in this.array&&a(this.array[d]))return d;return-1},indexOfElement:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var d=this.array.length,e=0;d>e;e++)if(e in this.array&&(null==b&&this.array[e]===a||null!=b&&b(this.array[e],a)))return e;return-1},intersect:function(a,b){if(null==a)return new d([],!1);b=c.createLambda(b);var e=d.from(a);if(c.processDeferredSort(e),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=function(a){return null==b?a===i:b(a,i)},k=c.some(g.array,j),l=c.some(e.array,j);!k&&l&&g.array.push(i)}return g},join:function(a,b,e,f,g){if(b=c.createLambda(b),e=c.createLambda(e),f=c.createLambda(f),g=c.createLambda(g),null==a)throw new Error("Invalid inner collection.");if(null==b||!c.isFunction(b))throw new Error("Invalid outer key selector.");if(null==e||!c.isFunction(e))throw new Error("Invalid inner key selector.");if(null==f||!c.isFunction(f))throw new Error("Invalid result selector.");if(null!=g&&!c.isFunction(g))throw new Error("Invalid key comparer.");null!=g&&(g=c.normalizeComparer(g)),c.processDeferredSort(this);for(var h=d.from(a),i=h.groupBy(e,null,g),j=this.array.length,k=[],l=0;j>l;l++)if(l in this.array){var m=this.array[l],n=b(m),o=i.firstOrDefault(null,function(a){return null==g?a.key===n:g(a.key,n)});if(null!=o&&o.values.length>0)for(var p=o.values.length,q=0;p>q;q++)k.push(f(m,o.values[q]))}return new d(k,!1)},last:function(a){if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length-1;b>=0;b--)if(b in this.array&&(null==a||a(this.array[b])))return this.array[b];throw new Error("No last item was found in collection.")},lastIndexOf:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=b-1;d>=0;d--)if(d in this.array&&a(this.array[d]))return d;return-1},lastIndexOfElement:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var d=this.array.length,e=d-1;e>=0;e--)if(e in this.array&&(null==b&&this.array[e]===a||null!=b&&b(this.array[e],a)))return e;return-1},lastOrDefault:function(a,b){if(1==arguments.length&&c.isFunction(a)&&(b=a,a=null),b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length-1;d>=0;d--)if(d in this.array&&(null==b||b(this.array[d])))return this.array[d];return a},min:function(a){if(0==this.array.length)throw new Error("No minimum element.");if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=null==a?this.array[0]:a(this.array[0]),e=1;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);d>f&&(d=f)}return d},minBy:function(a){if(0==this.array.length)throw new Error("No mininum element.");if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=a(this.array[0]),e=this.array[0],f=1;b>f;f++)if(f in this.array){var g=this.array[f],h=a(g);d>h&&(d=h,e=g)}return e},max:function(a){if(0==this.array.length)throw new Error("No maximum element.");if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=null==a?this.array[0]:a(this.array[0]),e=1;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);f>d&&(d=f)}return d},maxBy:function(a){if(0==this.array.length)throw new Error("No maximum element.");if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");c.processDeferredSort(this);for(var b=this.array.length,d=a(this.array[0]),e=this.array[0],f=1;b>f;f++)if(f in this.array){var g=this.array[f],h=a(g);h>d&&(d=h,e=g)}return e},orderBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null==b&&(b=c.defaultStringComparer),c.processDeferredSort(this);var e=new d(this.array);return e.deferredSort={keySelector:a,comparer:b,reverse:!1,next:null},e},orderByDescending:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null==b&&(b=c.defaultStringComparer),c.processDeferredSort(this);var e=new d(this.array);return e.deferredSort={keySelector:a,comparer:b,reverse:!0,next:null},e},pad:function(a,b){if(null==a||isNaN(a))throw new Error("Invalid width.");c.processDeferredSort(this);var e=this.array.length;return e>=a?new d(this.array):new d(this.array.concat(d.repeat(b,a-e).array),!1)},padWith:function(a,b){if(null==a||isNaN(a))throw new Error("Invalid width");if(b=c.createLambda(b),null==b||!c.isFunction(b))throw new Error("Invalid padding selector.");c.processDeferredSort(this);var e=this.array.length;if(e>=a)return new d(this.array);for(var f=[],g=e;a>g;g++)f.push(b(g));return new d(this.array.concat(f),!1)},pipe:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid action.");c.processDeferredSort(this);for(var b=this.array.length,e=0;b>e;e++)e in this.array&&a(this.array[e],e);return new d(this.array)},prepend:function(a){return c.processDeferredSort(this),new d([a].concat(this.array),!1)},prescan:function(a,b){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid operation.");c.processDeferredSort(this);var e=this.array.length;if(0==e)return new d([],!1);for(var f=b,g=[f],h=0;e-1>h;h++)h in this.array&&(f=a(f,this.array[h]),g.push(f));return new d(g,!1)},reverse:function(){return c.processDeferredSort(this),new d(this.array.reverse(),!1)},scan:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid operation.");c.processDeferredSort(this);var b=this.array.length;if(0==b)throw new Error("Cannot scan on empty collection.");for(var e=this.array[0],f=[e],g=1;b>g;g++)g in this.array&&(e=a(e,this.array[g]),f.push(e));return new d(f,!1)},select:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid selector.");return c.processDeferredSort(this),new d(c.map(this.array,a),!1)},selectMany:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid collection selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");c.processDeferredSort(this);for(var e=this.array.length,f=[],g=0;e>g;g++){var h=this.array[g],i=a(h,g);if(c.isArray(i)||(i=d.from(i).toArray()),null!=i&&i.length>0)for(var j=i.length,k=0;j>k;k++){var l=i[k],m=null==b?l:b(l,h);f.push(m)}}return new d(f,!1)},sequenceEqual:function(a,b){if(null==a)return!1;if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(a);c.processDeferredSort(e);var f=this.array.length;if(f!=e.array.length)return!1;for(var g=0;f>g;g++)if(null==b){if(this.array[g]!==e.array[g])return!1}else if(!b(this.array[g],e.array[g]))return!1;return!0},sequenceEquivalent:function(a,b){if(null==a)return!1;if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(a);c.processDeferredSort(e);var f=this.array.length,g=e.array.length;if(f!=g)return!1;var h=this.toLookup("x => x",b),i=e.toLookup("x => x",b);return h.count()==i.count()&&h.all(function(a){var c=i.firstOrDefault(null,function(c){return null==b?c.key===a.key:b(c.key,a.key)});return null==c?!1:a.values.length==c.values.length})},single:function(a){if(a=c.createLambda(a),null==a){if(0==this.array.length)throw new Error("No single item in the collection.");if(this.array.length>1)throw new Error("More than one item in the collection.");return c.processDeferredSort(this),this.array[0]}if(!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,d=!1,e=null,f=0;b>f;f++)if(f in this.array&&a(this.array[f])){if(d)throw new Error("More than one item matched the predicate in the collection.");d=!0,e=this.array[f]}if(!d)throw new Error("No single item matched the predicate in the collection.");return e},singleOrDefault:function(a,b){if(b=c.createLambda(b),null==b){if(0==this.array.length)return a;if(this.array.length>1)throw new Error("More than one item in the collection.");return c.processDeferredSort(this),this.array[0]}if(!c.isFunction(b))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var d=this.array.length,e=!1,f=null,g=0;d>g;g++)if(g in this.array&&b(this.array[g])){if(e)throw new Error("More than one item matched the predicate in the collection.");e=!0,f=this.array[g]}return e?f:a},singleOrFallback:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid fallback");if(c.processDeferredSort(this),0==this.array.length)return a();if(1==this.array.length)return this.array[0];throw new Error("More than one item in the collection.")},skip:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),new d(this.array.slice(a),!1)},skipUntil:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate");return this.skipWhile(function(b){return!a(b)})},skipWhile:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,e=[],f=!0,g=0;b>g;g++){var h=this.array[g];f?a(h)||(f=!1,e.push(h)):e.push(h)}return new d(e,!1)},sum:function(a){if(c.processDeferredSort(this),0==this.array.length)return 0;if(a=c.createLambda(a),null!=a&&!c.isFunction(a))throw new Error("Invalid selector.");for(var b=this.array.length,d=0,e=0;b>e;e++)if(e in this.array){var f=null==a?this.array[e]:a(this.array[e]);null!=f&&(d+=f)}return d},take:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),new d(this.array.slice(0,a),!1)},takeEvery:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),this.where(function(b,c){return c%a==0})},takeLast:function(a){if(null==a||isNaN(a))throw new Error("Invalid count.");return c.processDeferredSort(this),0>=a?new d([],!1):(a>this.array.length&&(a=this.array.length),new d(this.array.slice(this.array.length-a),!1))},takeUntil:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate");return this.takeWhile(function(b){return!a(b)})},takeWhile:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");c.processDeferredSort(this);for(var b=this.array.length,e=[],f=!0,g=0;b>g&&f;g++){var h=this.array[g];a(h)?e.push(h):f=!1}return new d(e,!1)},thenBy:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");if(null==this.deferredSort)throw new Error("ThenBy can only be called following an OrderBy/OrderByDescending.");null==b&&(b=c.defaultStringComparer);var e=new d(this.array);return e.deferredSort=c.extendDeferredSort(this.deferredSort,{keySelector:a,comparer:b,reverse:!1,next:null}),e},thenByDescending:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");if(null==this.deferredSort)throw new Error("ThenByDescending can only be called following an OrderBy/OrderByDescending.");null==b&&(b=c.defaultStringComparer);var e=new d(this.array);return e.deferredSort=c.extendDeferredSort(this.deferredSort,{keySelector:a,comparer:b,reverse:!0,next:null}),e},toDelimitedString:function(a){return null==a&&(a=","),c.processDeferredSort(this),this.array.join(a)},toDictionary:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid element selector.");c.processDeferredSort(this);for(var d=this.array.length,e={},f=0;d>f;f++){var g=this.array[f],h=a(g);if(h in e)throw new Error("Duplicate key in collection.");e[h]=null==b?g:b(g)}return e},toJQuery:function(){if(!jQuery)throw new Error("Cannot return jQuery object--jQuery not available.");return c.processDeferredSort(this),jQuery(this.array)},toLookup:function(a,b){if(a=c.createLambda(a),b=c.createLambda(b),null==a||!c.isFunction(a))throw new Error("Invalid key selector.");if(null!=b&&!c.isFunction(b))throw new Error("Invalid comparer");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);for(var e=new d([],!1),f=this.array.length,g=0;f>g;g++)if(g in this.array){var h=this.array[g],i=a(h),j=e.firstOrDefault(null,function(a){return null==b?a.key===i:b(a.key,i)});null==j&&(j={key:i,values:[]},e.array.push(j)),j.values.push(h)}return e},union:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid comparer.");null!=b&&(b=c.normalizeComparer(b)),c.processDeferredSort(this);var e=d.from(null==a?[]:a);c.processDeferredSort(e);for(var f=this.array.length,g=new d([],!1),h=0;f>h;h++)if(h in this.array){var i=this.array[h],j=c.some(g.array,function(a){return null==b?a===i:b(a,i)});j||g.array.push(i)}f=e.array.length;for(var h=0;f>h;h++)if(h in e.array){var i=e.array[h],j=c.some(g.array,function(a){return null==b?a===i:b(a,i)});j||g.array.push(i)}return g},where:function(a){if(a=c.createLambda(a),null==a||!c.isFunction(a))throw new Error("Invalid predicate.");return c.processDeferredSort(this),new d(c.filter(this.array,a),!1)},zip:function(a,b){if(b=c.createLambda(b),null!=b&&!c.isFunction(b))throw new Error("Invalid result selector.");if(null==b&&(b=c.merge),c.processDeferredSort(this),null==a)return new d([],!1);var e=d.from(a);c.processDeferredSort(e);for(var f=Math.min(this.array.length,e.array.length),g=[],h=0;f>h;h++)g.push(b(this.array[h],e.array[h]));return new d(g,!1)},zipLongest:function(a,b,e,f){if(f=c.createLambda(f),null!=f&&!c.isFunction(f))throw new Error("Invalid result selector.");null==f&&(f=c.merge),c.processDeferredSort(this);var g=d.from(a);c.processDeferredSort(g);for(var h=Math.max(this.array.length,g.array.length),i=[],j=0;h>j;j++)i.push(f(j>=this.array.length?b:this.array[j],j>=g.array.length?e:g.array[j]));return new d(i,!1)},toArray:function(){return c.processDeferredSort(this),this.array.slice(0)}},a.linq=d,a.$linq=d.from}(window);